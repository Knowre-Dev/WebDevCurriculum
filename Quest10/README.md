# Quest 10. 인증의 이해

## Introduction
* 이번 퀘스트에서는 웹에서의 인증에 관해 알아보겠습니다.

## Topics
* Cookie
* Session
* JWT

## Resources
* [MDN - HTTP 쿠키](https://developer.mozilla.org/ko/docs/Web/HTTP/Cookies)
* [Cookies and Sessions](https://web.stanford.edu/~ouster/cgi-bin/cs142-fall10/lecture.php?topic=cookie)
* [JWT](https://jwt.io/)

## Checklist
* 쿠키란 무엇일까요?
```
쿠키는 사용자가 웹 사이트와 상호 작용할 때 웹 서버에 의해 사용자 컴퓨터에 저장되는 작은 텍스트 파일입니다. 사용자의 브라우징 동작 및 기본 설정에 대한 정보를 저장하는 데 사용됩니다. 쿠키는 일반적으로 사용자 설정을 기억하고 사용자 세션을 유지하며 콘텐츠를 개인화하여 웹 사이트에서 사용자 경험을 향상시키는 데 사용됩니다.

쿠키는 웹서버가 이용자의 웹브라우저에게 보내는 것으로 이용자의 컴퓨터에 저장됩니다. 사용자가 향후 동일한 웹 사이트를 다시 방문하면 웹 브라우저는 쿠키를 웹 서버로 다시 전송하여 서버가 사용자를 인식하고 저장된 정보를 검색할 수 있도록 합니다. 쿠키는 영구적이거나 세션 기반일 수 있습니다.

영구 쿠키: 이 쿠키는 사용자가 웹 브라우저를 닫은 후에도 사용자의 컴퓨터에 남아 있습니다. 쿠키는 웹 사이트에서 설정한 만료 날짜가 있으며 웹 사이트를 여러 번 방문하는 동안 사용자 기본 설정 또는 설정을 기억하는 데 사용됩니다.
세션 쿠키: 이 쿠키는 일시적이며 사용자가 웹사이트를 사용하는 동안에만 사용자 컴퓨터의 메모리에 저장됩니다. 일반적으로 인증 자격 증명과 같은 사용자 세션 정보를 유지하는 데 사용되며 사용자가 웹 브라우저를 닫으면 삭제됩니다.

쿠키는 다음과 같은 다양한 목적으로 사용됩니다.

인증: 쿠키는 일반적으로 사용자 인증 세션을 유지하는 데 사용되어 사용자가 웹사이트에 로그인하고 여러 페이지 또는 방문에 걸쳐 로그인 상태를 유지할 수 있도록 합니다.
개인화: 쿠키는 언어 기본 설정, 글꼴 크기 및 색 구성표와 같은 사용자 기본 설정 및 설정을 저장하여 웹 사이트에서 사용자 경험을 사용자 정의할 수 있습니다.
분석: 쿠키는 웹사이트 성능을 분석하고 사용자 경험을 개선하기 위해 페이지 보기, 클릭 및 탐색 경로와 같은 웹사이트에서의 사용자 행동에 대한 익명 데이터를 수집하는 데 사용할 수 있습니다.
광고: 쿠키는 사용자의 검색 기록 및 기본 설정을 기반으로 대상 광고를 제공하기 위해 사용자의 관심과 행동을 추적할 수 있습니다.

쿠키는 잠재적으로 사용자 행동을 추적하고 개인 정보를 수집할 수 있으므로 개인 정보 보호 문제를 제기할 수도 있다는 점에 유의해야 합니다. 따라서 웹사이트는 쿠키 사용에 대한 명확한 정보를 제공하고 해당 개인 정보 보호법 및 규정에 따라 사용자 동의를 얻어야 합니다. 사용자는 원하는 경우 쿠키 삭제 또는 차단을 포함하여 웹 브라우저에서 쿠키 설정을 관리할 수도 있습니다.
```
  * 쿠키는 어떤 식으로 동작하나요?
  ```
  쿠키는 사용자 컴퓨터의 웹 서버에 의해 생성되고 저장된 다음 동일한 사용자의 웹 브라우저에서 후속 요청과 함께 동일한 서버로 다시 전송되는 방식으로 작동합니다. 프로세스에는 일반적으로 다음 단계가 포함됩니다.
  1. 생성: 사용자가 웹사이트를 방문하면 웹 서버는 하나 이상의 쿠키를 포함할 수 있는 HTTP 응답을 사용자의 웹 브라우저에 보냅니다. 쿠키는 일반적으로 고유 식별자, 사용자 기본 설정 또는 세션 데이터와 같은 정보가 포함된 작은 텍스트 파일입니다.
  2. 저장: 웹 브라우저는 서버에서 쿠키를 수신하여 사용자 컴퓨터에 로컬로 저장합니다. 쿠키는 쿠키 유형 및 브라우저 설정에 따라 쿠키 파일 또는 브라우저 메모리와 같은 지정된 위치에 저장됩니다.
  3. 전송: 사용자가 향후 동일한 웹 사이트를 다시 방문하면 웹 브라우저는 페이지 요청과 함께 웹 서버로 전송되는 HTTP 요청에 저장된 쿠키를 포함합니다. 쿠키는 요청 헤더의 일부로 전송되며 브라우저에 의해 자동으로 포함됩니다.
  4. 검색: 웹 서버는 사용자의 브라우저에서 요청을 수신하고 요청 헤더에 포함된 쿠키에 액세스할 수 있습니다. 그런 다음 서버는 쿠키에 저장된 정보를 검색하고 이를 사용하여 사용자 경험을 개인화하고 사용자 세션을 유지하거나 다른 작업을 수행할 수 있습니다.
  5. 만료: 쿠키는 웹 서버에 의해 설정된 만료 날짜를 가질 수 있습니다. 쿠키가 만료 날짜에 도달하면 웹 브라우저는 자동으로 사용자의 컴퓨터에서 쿠키를 삭제합니다. 세션 쿠키는 일반적으로 사용자가 웹 브라우저를 닫을 때 삭제되는 반면 영구 쿠키는 만료일까지 또는 사용자가 수동으로 삭제할 때까지 사용자의 컴퓨터에 남아 있을 수 있습니다.
  쿠키는 쿠키를 만든 동일한 도메인으로만 전송되며 웹 브라우저는 일반적으로 쿠키에 대한 도메인 간 액세스를 방지하기 위해 이 동일 출처 정책을 시행하므로 사용자 개인 정보 및 보안을 보호하는 데 도움이 됩니다. 또한 쿠키는 많은 국가에서 개인 정보 보호 규정을 따르며 웹 사이트는 쿠키 사용에 대한 명확한 정보를 제공하고 해당 법률 및 규정에 따라 사용자 동의를 얻어야 합니다.
  ```
  * 쿠키는 어떤 식으로 서버와 클라이언트 사이에 정보를 주고받나요?
  ```
  쿠키는 서버와 클라이언트 간에 교환되는 요청 및 응답 메시지의 HTTP 헤더를 사용하여 서버와 클라이언트(일반적으로 웹 브라우저) 간에 정보를 전달합니다. 프로세스는 다음과 같이 요약할 수 있습니다.
  1. 서버 측: 사용자가 웹사이트를 방문하면 웹 서버는 하나 이상의 쿠키를 포함하는 응답을 생성합니다. 서버는 쿠키 값을 설정하고 응답 헤더에 포함합니다. 쿠키는 일반적으로 쿠키의 이름-값 쌍과 만료일, 도메인 및 경로와 같은 추가 속성을 포함하는 "Set-Cookie" 헤더로 전송됩니다.
  2. 클라이언트 측: 클라이언트(웹 브라우저)는 "Set-Cookie" 헤더의 쿠키를 포함하여 서버로부터 응답을 받습니다. 클라이언트는 쿠키 유형 및 브라우저 설정에 따라 쿠키 파일 또는 브라우저 메모리와 같은 지정된 위치의 사용자 컴퓨터에 로컬로 쿠키를 저장합니다.
  3. 보내기: 사용자가 동일한 웹 사이트를 다시 방문하거나 동일한 도메인에 대한 후속 요청을 할 때 클라이언트는 서버로 전송되는 HTTP 요청의 "Cookie" 헤더에 저장된 쿠키를 자동으로 포함합니다. "Cookie" 헤더에는 쿠키의 이름-값 쌍이 포함되어 있으며 서버는 이를 통해 쿠키에 저장된 정보에 액세스하고 검색할 수 있습니다.
  4. 검색: 서버는 클라이언트로부터 요청을 받고 "Cookie" 헤더에 포함된 쿠키에 액세스할 수 있습니다. 서버는 사용자 기본 설정, 세션 데이터 또는 기타 데이터와 같이 쿠키에 저장된 정보를 검색하고 이를 사용하여 응답을 사용자 지정하거나 필요에 따라 다른 작업을 수행합니다.
  5. 만료: 쿠키는 서버에 의해 설정된 만료 날짜를 가질 수 있으며, 클라이언트는 만료된 쿠키를 사용자의 컴퓨터에서 자동으로 삭제합니다. 이 프로세스는 일반적으로 후속 요청을 서버에 보내기 전에 클라이언트에서 수행합니다.
  쿠키는 쿠키를 만든 동일한 도메인으로만 전송되며 웹 브라우저는 일반적으로 쿠키에 대한 도메인 간 액세스를 방지하기 위해 이 동일 출처 정책을 시행하므로 사용자 개인 정보 및 보안을 보호하는 데 도움이 됩니다. 또한 쿠키는 많은 국가에서 개인 정보 보호 규정의 적용을 받으며 웹 사이트는 쿠키 사용에 대한 명확한 정보를 제공하고 해당 법률 및 규정에 따라 사용자 동의를 얻어야 합니다.
  ```
* 웹 어플리케이션의 세션이란 무엇일까요?
```
웹 응용 프로그램의 맥락에서 세션은 사용자가 웹 응용 프로그램과 상호 작용하는 기간을 말하며 일반적으로 사용자가 로그인하거나 세션을 시작할 때 시작하여 사용자가 로그아웃하거나 세션 시간이 초과될 때 종료됩니다. 비활성으로.

세션을 통해 웹 애플리케이션은 여러 요청 및 응답에서 사용자의 상호 작용에 대한 상태 저장 정보를 유지 관리하여 개인화되고 동적인 기능을 사용할 수 있습니다. 세션 중에 웹 애플리케이션은 사용자가 요청할 때마다 데이터를 다시 입력할 필요 없이 사용자 기본 설정, 인증 상태, 장바구니 내용 또는 기타 애플리케이션별 데이터와 같은 사용자별 데이터를 저장하고 검색할 수 있습니다.

세션은 일반적으로 서버 측에서 구현되며 세션 식별자, 쿠키 또는 URL 재작성과 같은 세션 관리 기술을 사용합니다. 사용자가 세션을 시작하면 일반적으로 세션 식별자가 생성되고 서버 또는 데이터베이스에 저장되는 사용자의 세션 데이터와 연결됩니다. 그런 다음 세션 식별자는 클라이언트에 전송되고(예: 쿠키로 또는 URL에 추가됨) 클라이언트의 후속 요청에 포함되어 세션을 식별하고 관련 세션 데이터를 검색합니다.

세션은 서버측 세션 관리, 클라이언트측 세션 관리 또는 이 둘의 조합과 같은 다양한 방법을 사용하여 관리할 수 있습니다. 서버측 세션 관리에는 세션 데이터를 서버에 저장하고 세션 식별자와 연결하는 것이 포함되며, 클라이언트측 세션 관리에는 클라이언트측에 세션 데이터를 저장(예: 쿠키 또는 로컬 저장소)하고 세션을 포함하는 작업이 포함됩니다. 후속 요청의 데이터.

세션 관리는 민감한 사용자 데이터를 처리하고 인증 및 권한 부여를 관리하는 것과 관련되므로 웹 애플리케이션 보안의 중요한 측면이라는 점에 유의해야 합니다. 보안 세션 식별자 사용, 세션 데이터 암호화, 적절한 세션 시간 초과 및 만료 설정 지정과 같은 적절한 세션 관리 기술은 세션 하이재킹, 세션 고정 및 기타 보안 위협으로부터 보호하는 데 필수적입니다.
```
  * 세션의 ID와 내용은 각각 어디에 저장되고 어떻게 서버와 교환되나요?
  ```
  세션의 ID와 내용은 일반적으로 서로 다른 위치에 저장되며 서버와의 교환 방법은 웹 애플리케이션에서 사용되는 세션 관리 기술에 따라 다릅니다. 두 가지 일반적인 접근 방식이 있습니다.
  1. 서버 측 세션 관리: 이 접근 방식에서는 세션 ID와 내용이 서버에 저장됩니다. 사용자가 세션을 시작하면 서버는 고유한 세션 ID를 생성하고 이를 서버의 메모리나 데이터베이스에 저장된 세션 데이터와 연결합니다. 그런 다음 세션 ID는 클라이언트로 전송되고(일반적으로 쿠키로 또는 URL에 추가됨) 클라이언트에서 서버로의 후속 요청에 포함됩니다.
  세션 ID는 서버에 저장된 세션 데이터에 대한 참조 역할을 합니다. 서버는 클라이언트로부터 요청을 받으면 요청에 포함된 세션 ID를 사용하여 해당 세션 데이터를 식별하고 세션의 내용을 검색합니다. 그런 다음 서버는 세션 내용을 사용하여 응답을 사용자 지정하거나 필요에 따라 다른 작업을 수행할 수 있습니다.
  2. 클라이언트 측 세션 관리: 이 접근 방식에서 세션 ID와 콘텐츠는 일반적으로 쿠키 또는 로컬 스토리지에 있는 클라이언트 측에 저장됩니다. 사용자가 세션을 시작하면 세션 ID와 콘텐츠가 클라이언트의 브라우저에 저장됩니다. 세션 ID는 일반적으로 HTTP 요청의 "Cookie" 헤더에 쿠키로 서버에 전송되며 서버는 세션 ID를 사용하여 해당 세션 데이터를 식별하고 세션 내용을 검색합니다.
  두 접근 방식 모두에서 세션 ID는 서버 또는 클라이언트 측에 저장된 세션 데이터를 참조하기 위해 서버와 클라이언트 간에 교환되는 고유 식별자 역할을 합니다. 세션 콘텐츠에는 일반적으로 사용자 기본 설정, 인증 상태 또는 기타 응용 프로그램 관련 데이터와 같은 사용자 또는 세션 관련 데이터가 포함됩니다.
  세션 ID 및 콘텐츠를 포함한 세션 데이터의 교환은 무단 액세스로부터 보호하고 세션 데이터의 기밀성과 무결성을 보장하기 위해 암호화 및 인증과 같은 적절한 조치를 사용하여 보안을 유지해야 합니다. 적절한 세션 관리 기술 및 보안 조치는 사용자 데이터를 보호하고 세션 관련 취약점 및 공격으로부터 보호하는 데 중요합니다.
  ```
* JWT란 무엇인가요?
```
JWT는 JSON 웹 토큰을 나타냅니다. JSON 개체로 당사자 간에 전송될 클레임을 나타내는 컴팩트한 URL 안전 수단입니다. JWT는 종종 웹 애플리케이션 및 API에서 인증 및 권한 부여 목적으로 사용됩니다.

JWT는 헤더, 페이로드 및 서명의 세 부분으로 구성됩니다. 헤더에는 일반적으로 토큰 유형(JSON 웹 토큰의 경우 "JWT") 및 토큰 서명에 사용되는 알고리즘에 대한 정보가 포함됩니다. 페이로드에는 사용자 ID, 만료 시간 및 기타 사용자 지정 클레임과 같이 인증 중인 사용자 또는 엔터티에 대한 클레임 또는 정보가 포함됩니다. 서명은 암호화된 헤더, 암호화된 페이로드, 비밀 키를 지정된 알고리즘으로 해싱하여 생성되며 토큰의 무결성 및 진위를 확인하는 데 사용됩니다.

JWT는 상태 비저장 및 확장 가능한 방식으로 당사자 간에 인증 정보를 전송하는 수단으로 자주 사용됩니다. 사용자가 로그인하거나 인증하면 서버는 JWT를 생성하고 이를 응답에 포함합니다. 그런 다음 클라이언트는 일반적으로 로컬 스토리지 또는 쿠키에 JWT를 저장하고 "Authorization" 헤더의 서버에 대한 후속 요청에 포함할 수 있습니다. 그런 다음 서버는 JWT의 서명을 확인하고 페이로드를 디코딩하여 사용자 또는 엔티티 정보를 얻은 다음 이를 사용하여 요청된 작업을 인증하고 권한을 부여할 수 있습니다.

JWT 사용의 이점 중 하나는 JWT가 독립적이라는 점입니다. 즉, 필요한 모든 정보가 토큰 자체에 포함되어 있고 세션 데이터를 서버에 저장할 필요가 없습니다. 따라서 JWT는 확장 가능하고 분산 시스템에 적합합니다. JWT는 또한 당사자 간에 URL 안전 문자열로 쉽게 전송할 수 있으므로 이식성이 있어 API 및 마이크로서비스에서 사용하기에 이상적입니다.

그러나 JWT를 제대로 보호하지 않으면 잠재적으로 변조되거나 가로챌 수 있으므로 JWT를 안전하게 처리하는 것이 중요합니다. JWT의 기밀성, 무결성 및 신뢰성을 보장하기 위해 서명, 서명 유효성 검사 및 비밀 키의 안전한 저장을 위한 보안 알고리즘 사용과 같은 적절한 조치를 구현해야 합니다. 또한 JWT의 페이로드 콘텐츠는 토큰에 액세스할 수 있는 모든 사람이 볼 수 있으므로 적절한 암호화 또는 마스킹 없이 민감한 정보를 페이로드에 포함해서는 안 됩니다.
```
  * JWT 토큰은 어디에 저장되고 어떻게 서버와 교환되나요?
  ```
  JWT 토큰은 상태 비저장 및 독립형으로 설계되었기 때문에 일반적으로 클라이언트 측 로컬 저장소, 세션 저장소 또는 쿠키에 저장됩니다. 서버는 성공적인 인증 또는 권한 부여 시 JWT 토큰을 생성하고 이를 클라이언트에 대한 응답에 포함합니다. 그런 다음 클라이언트는 JWT 토큰을 저장하고 추가 작업을 인증하고 승인하는 수단으로 서버에 대한 후속 요청에 포함합니다.
  JWT 토큰을 서버와 교환하는 정확한 방법은 애플리케이션의 아키텍처 및 구현에 따라 다릅니다. 다음은 몇 가지 일반적인 접근 방식입니다.
  1. 인증 헤더: JWT 토큰은 HTTP 요청의 "인증" 헤더에 포함될 수 있습니다. 클라이언트는 헤더 값을 "Bearer {JWT 토큰}"으로 설정합니다. 여기서 "{JWT 토큰}"은 실제 JWT 토큰입니다. 그런 다음 서버는 "Authorization" 헤더에서 토큰을 확인하고 페이로드를 디코딩하여 사용자 또는 엔터티 정보를 얻은 다음 이를 사용하여 요청된 작업을 인증하고 권한을 부여합니다.
  2. 쿠키: JWT 토큰은 클라이언트의 브라우저에 쿠키로 저장될 수 있습니다. 서버는 응답에 JWT 토큰을 쿠키로 포함하고 클라이언트의 브라우저는 자동으로 쿠키를 후속 요청과 함께 서버로 다시 보냅니다. 그런 다음 서버는 쿠키에서 토큰을 확인하고 페이로드를 디코딩하여 인증 및 권한 부여에 사용합니다.
  3. 쿼리 매개변수: JWT 토큰은 HTTP 요청의 URL에 쿼리 매개변수로 포함될 수 있습니다. 클라이언트는 "?token={JWT 토큰}"과 같은 쿼리 매개변수로 JWT 토큰을 URL에 추가합니다. 그런 다음 서버는 쿼리 매개변수에서 토큰을 추출하고 이를 확인하며 페이로드를 디코딩하고 인증 및 권한 부여에 사용합니다.
  JWT 토큰을 서버와 교환할 때 무단 액세스로부터 보호하고 JWT의 기밀성, 무결성 및 신뢰성을 보장하기 위해 적절한 보안 조치를 구현해야 한다는 점에 유의해야 합니다. 여기에는 보안 통신 채널(예: HTTPS)을 사용하여 토큰을 전송하고, 서버 측에서 토큰을 적절하게 검증 및 확인하고, XSS(교차 사이트 스크립팅) 및 CSRF(교차 사이트 요청 위조) 공격으로부터 토큰을 보호하는 것이 포함됩니다.
  ```
* 세션에 비해 JWT가 가지는 장점은 무엇인가요? 또 JWT에 비해 세션이 가지는 장점은 무엇인가요?
```
세션에 비해 JWT의 장점:

1. 상태 비저장: JWT는 상태 비저장이므로 필요한 모든 정보가 토큰 자체에 포함되어 있습니다. 이를 통해 서버 측 세션 스토리지가 필요하지 않으므로 JWT의 확장성이 향상되고 여러 서버 또는 마이크로 서비스가 포함될 수 있는 분산 시스템에 적합합니다.
2. 이식성: JWT는 이식성이 있으며 당사자 간에 URL 안전 문자열로 쉽게 전송할 수 있습니다. 따라서 서로 다른 서비스 또는 도메인 간에 인증 및 권한 부여 정보를 전달해야 할 수 있는 API 및 마이크로 서비스에서 사용하기에 이상적입니다.
3. 분산형: JWT는 분산형 인증 및 승인을 허용합니다. JWT를 생성하는 서버는 토큰에 사용자 지정 클레임을 포함하여 권한 및 역할을 세밀하게 제어할 수 있습니다. 이렇게 하면 데이터베이스를 자주 조회하거나 세션 상태를 공유할 필요가 없으므로 특정 시나리오에서 JWT가 더 효율적입니다.

JWT에 비해 세션의 장점:

1. 서버 측 제어: 세션은 서버 측에서 관리되므로 세션 상태 및 사용자 세션을 보다 세밀하게 제어할 수 있습니다. 이는 세션 관리를 위해 서버 측 처리 또는 사용자 지정이 필요한 시나리오에서 유용할 수 있습니다.
2. 철회: 서버측에서 세션을 쉽게 철회할 수 있으므로 사용자 세션을 즉시 종료할 수 있습니다. 반대로 JWT는 일반적으로 사전 정의된 만료 시간이 있으며 토큰 취소 목록 또는 블랙리스트 작성과 같은 추가 조치가 구현되지 않는 한 만료 전에 쉽게 취소할 수 없습니다.
3. 호환성: 세션은 쿠키 또는 기타 서버측 메커니즘에 의존하므로 대부분의 웹 브라우저에서 즉시 지원됩니다. 반면에 JWT는 토큰 생성, 유효성 검사 및 저장을 처리하기 위해 추가 클라이언트 측 구현 또는 라이브러리가 필요할 수 있습니다.

JWT와 세션 간의 선택은 애플리케이션의 특정 요구 사항과 제약 조건에 따라 다릅니다. JWT는 일반적으로 API 및 마이크로 서비스와 같이 확장성과 이식성이 중요한 상태 비저장 및 분산 시스템에서 선호됩니다. 반면 세션은 서버 측 제어, 해지 또는 레거시 시스템이나 브라우저와의 호환성이 우선 순위인 시나리오에서 선호될 수 있습니다. 인증 및 권한 부여 메커니즘의 기밀성, 무결성 및 신뢰성을 보장하기 위해 적절한 보안 조치를 구현해야 합니다.
```
## Quest
* 이번에는 메모장 시스템에 로그인 기능을 넣고자 합니다.
  * 사용자는 딱 세 명만 존재한다고 가정하고, 아이디와 비밀번호, 사용자의 닉네임은 하드코딩해도 무방합니다.
  * 로그인했을 때 해당 사용자가 이전에 작업했던 탭들과 마지막으로 활성화된 탭 등의 상태가 로딩 되어야 합니다.
  * 세션을 이용한 버전과, JWT를 이용한 버전 두 가지를 만들어 보세요!
    * 세션을 이용할 경우 세션은 서버의 메모리나 파일에 저장하면 됩니다.

## Advanced
* Web Authentication API(WebAuthn)은 무엇인가요?
